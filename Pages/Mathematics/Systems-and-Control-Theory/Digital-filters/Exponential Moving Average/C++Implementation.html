<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>
    <meta charset="UTF-8">
    <meta name="author" content="Pieter P">
    <link rel="stylesheet" type="text/css" href="/CSS/Pages.css">
    <link href="/CSS/roboto.css" rel="stylesheet" type="text/css">
    <link href="/CSS/icon.css" rel="stylesheet" type="text/css">
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            TeX: { equationNumbers: { autoNumber: "AMS" } },
            "fast-preview": {
            disabled: true
            }
        });
    </script>
    <script type="text/javascript" src="/MathJax/MathJax.js?config=TeX-AMS_SVG"></script>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <meta name="theme-color" content="#ccc">
    <meta name="keywords" content="EMA, Exponential Moving Average, IIR filter, filters, DSP, C++, implementation, algorithm">
    <meta name="description" content="A very fast and efficient Exponential Moving Average implementation in C++.">
    <title>C++ Implementation</title>
<style type="text/css">.mjx-chtml {display: inline-block; line-height: 0; text-indent: 0; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; margin: 0; padding: 1px 0}
.MJXc-display {display: block; text-align: center; margin: 1em 0; padding: 0}
.mjx-chtml[tabindex]:focus, body :focus .mjx-chtml[tabindex] {display: inline-table}
.mjx-full-width {text-align: center; display: table-cell!important; width: 10000em}
.mjx-math {display: inline-block; border-collapse: separate; border-spacing: 0}
.mjx-math * {display: inline-block; -webkit-box-sizing: content-box!important; -moz-box-sizing: content-box!important; box-sizing: content-box!important; text-align: left}
.mjx-numerator {display: block; text-align: center}
.mjx-denominator {display: block; text-align: center}
.MJXc-stacked {height: 0; position: relative}
.MJXc-stacked > * {position: absolute}
.MJXc-bevelled > * {display: inline-block}
.mjx-stack {display: inline-block}
.mjx-op {display: block}
.mjx-under {display: table-cell}
.mjx-over {display: block}
.mjx-over > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-under > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-stack > .mjx-sup {display: block}
.mjx-stack > .mjx-sub {display: block}
.mjx-prestack > .mjx-presup {display: block}
.mjx-prestack > .mjx-presub {display: block}
.mjx-delim-h > .mjx-char {display: inline-block}
.mjx-surd {vertical-align: top}
.mjx-mphantom * {visibility: hidden}
.mjx-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 2px 3px; font-style: normal; font-size: 90%}
.mjx-annotation-xml {line-height: normal}
.mjx-menclose > svg {fill: none; stroke: currentColor}
.mjx-mtr {display: table-row}
.mjx-mlabeledtr {display: table-row}
.mjx-mtd {display: table-cell; text-align: center}
.mjx-label {display: table-row}
.mjx-box {display: inline-block}
.mjx-block {display: block}
.mjx-span {display: inline}
.mjx-char {display: block; white-space: pre}
.mjx-itable {display: inline-table; width: auto}
.mjx-row {display: table-row}
.mjx-cell {display: table-cell}
.mjx-table {display: table; width: 100%}
.mjx-line {display: block; height: 0}
.mjx-strut {width: 0; padding-top: 1em}
.mjx-vsize {width: 0}
.MJXc-space1 {margin-left: .167em}
.MJXc-space2 {margin-left: .222em}
.MJXc-space3 {margin-left: .278em}
.mjx-test.mjx-test-display {display: table!important}
.mjx-test.mjx-test-inline {display: inline!important; margin-right: -1px}
.mjx-test.mjx-test-default {display: block!important; clear: both}
.mjx-ex-box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.mjx-test-inline .mjx-left-box {display: inline-block; width: 0; float: left}
.mjx-test-inline .mjx-right-box {display: inline-block; width: 0; float: right}
.mjx-test-display .mjx-right-box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MJXc-TeX-unknown-R {font-family: monospace; font-style: normal; font-weight: normal}
.MJXc-TeX-unknown-I {font-family: monospace; font-style: italic; font-weight: normal}
.MJXc-TeX-unknown-B {font-family: monospace; font-style: normal; font-weight: bold}
.MJXc-TeX-unknown-BI {font-family: monospace; font-style: italic; font-weight: bold}
.MJXc-TeX-ams-R {font-family: MJXc-TeX-ams-R,MJXc-TeX-ams-Rw}
.MJXc-TeX-cal-B {font-family: MJXc-TeX-cal-B,MJXc-TeX-cal-Bx,MJXc-TeX-cal-Bw}
.MJXc-TeX-frak-R {font-family: MJXc-TeX-frak-R,MJXc-TeX-frak-Rw}
.MJXc-TeX-frak-B {font-family: MJXc-TeX-frak-B,MJXc-TeX-frak-Bx,MJXc-TeX-frak-Bw}
.MJXc-TeX-math-BI {font-family: MJXc-TeX-math-BI,MJXc-TeX-math-BIx,MJXc-TeX-math-BIw}
.MJXc-TeX-sans-R {font-family: MJXc-TeX-sans-R,MJXc-TeX-sans-Rw}
.MJXc-TeX-sans-B {font-family: MJXc-TeX-sans-B,MJXc-TeX-sans-Bx,MJXc-TeX-sans-Bw}
.MJXc-TeX-sans-I {font-family: MJXc-TeX-sans-I,MJXc-TeX-sans-Ix,MJXc-TeX-sans-Iw}
.MJXc-TeX-script-R {font-family: MJXc-TeX-script-R,MJXc-TeX-script-Rw}
.MJXc-TeX-type-R {font-family: MJXc-TeX-type-R,MJXc-TeX-type-Rw}
.MJXc-TeX-cal-R {font-family: MJXc-TeX-cal-R,MJXc-TeX-cal-Rw}
.MJXc-TeX-main-B {font-family: MJXc-TeX-main-B,MJXc-TeX-main-Bx,MJXc-TeX-main-Bw}
.MJXc-TeX-main-I {font-family: MJXc-TeX-main-I,MJXc-TeX-main-Ix,MJXc-TeX-main-Iw}
.MJXc-TeX-main-R {font-family: MJXc-TeX-main-R,MJXc-TeX-main-Rw}
.MJXc-TeX-math-I {font-family: MJXc-TeX-math-I,MJXc-TeX-math-Ix,MJXc-TeX-math-Iw}
.MJXc-TeX-size1-R {font-family: MJXc-TeX-size1-R,MJXc-TeX-size1-Rw}
.MJXc-TeX-size2-R {font-family: MJXc-TeX-size2-R,MJXc-TeX-size2-Rw}
.MJXc-TeX-size3-R {font-family: MJXc-TeX-size3-R,MJXc-TeX-size3-Rw}
.MJXc-TeX-size4-R {font-family: MJXc-TeX-size4-R,MJXc-TeX-size4-Rw}
.MJXc-TeX-vec-R {font-family: MJXc-TeX-vec-R,MJXc-TeX-vec-Rw}
.MJXc-TeX-vec-B {font-family: MJXc-TeX-vec-B,MJXc-TeX-vec-Bx,MJXc-TeX-vec-Bw}
@font-face {font-family: MJXc-TeX-ams-R; src: local('MathJax_AMS'), local('MathJax_AMS-Regular')}
@font-face {font-family: MJXc-TeX-ams-Rw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_AMS-Regular.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-B; src: local('MathJax_Caligraphic Bold'), local('MathJax_Caligraphic-Bold')}
@font-face {font-family: MJXc-TeX-cal-Bx; src: local('MathJax_Caligraphic'); font-weight: bold}
@font-face {font-family: MJXc-TeX-cal-Bw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Bold.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Bold.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-R; src: local('MathJax_Fraktur'), local('MathJax_Fraktur-Regular')}
@font-face {font-family: MJXc-TeX-frak-Rw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Regular.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Regular.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-B; src: local('MathJax_Fraktur Bold'), local('MathJax_Fraktur-Bold')}
@font-face {font-family: MJXc-TeX-frak-Bx; src: local('MathJax_Fraktur'); font-weight: bold}
@font-face {font-family: MJXc-TeX-frak-Bw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Bold.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Bold.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-BI; src: local('MathJax_Math BoldItalic'), local('MathJax_Math-BoldItalic')}
@font-face {font-family: MJXc-TeX-math-BIx; src: local('MathJax_Math'); font-weight: bold; font-style: italic}
@font-face {font-family: MJXc-TeX-math-BIw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Math-BoldItalic.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-R; src: local('MathJax_SansSerif'), local('MathJax_SansSerif-Regular')}
@font-face {font-family: MJXc-TeX-sans-Rw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Regular.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Regular.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-B; src: local('MathJax_SansSerif Bold'), local('MathJax_SansSerif-Bold')}
@font-face {font-family: MJXc-TeX-sans-Bx; src: local('MathJax_SansSerif'); font-weight: bold}
@font-face {font-family: MJXc-TeX-sans-Bw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Bold.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Bold.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-I; src: local('MathJax_SansSerif Italic'), local('MathJax_SansSerif-Italic')}
@font-face {font-family: MJXc-TeX-sans-Ix; src: local('MathJax_SansSerif'); font-style: italic}
@font-face {font-family: MJXc-TeX-sans-Iw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Italic.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-script-R; src: local('MathJax_Script'), local('MathJax_Script-Regular')}
@font-face {font-family: MJXc-TeX-script-Rw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Script-Regular.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-type-R; src: local('MathJax_Typewriter'), local('MathJax_Typewriter-Regular')}
@font-face {font-family: MJXc-TeX-type-Rw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Typewriter-Regular.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Typewriter-Regular.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Typewriter-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-R; src: local('MathJax_Caligraphic'), local('MathJax_Caligraphic-Regular')}
@font-face {font-family: MJXc-TeX-cal-Rw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Regular.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-B; src: local('MathJax_Main Bold'), local('MathJax_Main-Bold')}
@font-face {font-family: MJXc-TeX-main-Bx; src: local('MathJax_Main'); font-weight: bold}
@font-face {font-family: MJXc-TeX-main-Bw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Main-Bold.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-I; src: local('MathJax_Main Italic'), local('MathJax_Main-Italic')}
@font-face {font-family: MJXc-TeX-main-Ix; src: local('MathJax_Main'); font-style: italic}
@font-face {font-family: MJXc-TeX-main-Iw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Main-Italic.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-R; src: local('MathJax_Main'), local('MathJax_Main-Regular')}
@font-face {font-family: MJXc-TeX-main-Rw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-I; src: local('MathJax_Math Italic'), local('MathJax_Math-Italic')}
@font-face {font-family: MJXc-TeX-math-Ix; src: local('MathJax_Math'); font-style: italic}
@font-face {font-family: MJXc-TeX-math-Iw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size1-R; src: local('MathJax_Size1'), local('MathJax_Size1-Regular')}
@font-face {font-family: MJXc-TeX-size1-Rw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Size1-Regular.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size2-R; src: local('MathJax_Size2'), local('MathJax_Size2-Regular')}
@font-face {font-family: MJXc-TeX-size2-Rw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Size2-Regular.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size3-R; src: local('MathJax_Size3'), local('MathJax_Size3-Regular')}
@font-face {font-family: MJXc-TeX-size3-Rw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Size3-Regular.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size4-R; src: local('MathJax_Size4'), local('MathJax_Size4-Regular')}
@font-face {font-family: MJXc-TeX-size4-Rw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Size4-Regular.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-vec-R; src: local('MathJax_Vector'), local('MathJax_Vector-Regular')}
@font-face {font-family: MJXc-TeX-vec-Rw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Vector-Regular.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Vector-Regular.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Vector-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-vec-B; src: local('MathJax_Vector Bold'), local('MathJax_Vector-Bold')}
@font-face {font-family: MJXc-TeX-vec-Bx; src: local('MathJax_Vector'); font-weight: bold}
@font-face {font-family: MJXc-TeX-vec-Bw; src /*1*/: url('/MathJax/fonts/HTML-CSS/TeX/eot/MathJax_Vector-Bold.eot'); src /*2*/: url('/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Vector-Bold.woff') format('woff'), url('/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Vector-Bold.otf') format('opentype')}
</style></head>
<body>
    <nav>
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 48 48" style="position:absolute;top:4px;right: 4px;">
                <path d="M0 0h48v48h-48z" fill="none"></path>
                <path d="M6 36h36v-4h-36v4zm0-10h36v-4h-36v4zm0-14v4h36v-4h-36z"></path>
            </svg>
            <h2><a href="/">Home</a></h2>
<ul>
    <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../../Raspberry-Pi/index.html">Raspberry Pi</a>
    <ul>
        <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../../Raspberry-Pi/Installation+Setup/index.html">Installation and Setup</a>
        <ul>
            <li><span class="ftriangle"></span><a href="../../../../Raspberry-Pi/Installation+Setup/Setting-up-Ubuntu.html">Installing and Setting up Ubuntu</a></li>
            <li><span class="ftriangle"></span><a href="../../../../Raspberry-Pi/Installation+Setup/WiFi-Setup.html">Setting up the WiFi Connection</a></li>
        </ul>
        </li>
        <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../../Raspberry-Pi/Python-Development/index.html">Python Development</a>
        <ul>
        </ul>
        </li>
        <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../../Raspberry-Pi/C++-Development/index.html">C++ Development</a>
        <ul>
            <li><span class="ftriangle"></span><a href="../../../../Raspberry-Pi/C++-Development/Installation.html">Installation and setup</a></li>
            <li><span class="ftriangle"></span><a href="../../../../Raspberry-Pi/C++-Development/Building-The-Toolchain.html">Building the Cross-Compilation Toolchain</a></li>
            <li><span class="ftriangle"></span><a href="../../../../Raspberry-Pi/C++-Development/Dependencies.html">Cross-Compiling the Dependencies</a></li>
            <li><span class="ftriangle"></span><a href="../../../../Raspberry-Pi/C++-Development/Editor-Setup.html">Setting up Visual Studio Code for C++ Development</a></li>
            <li><span class="ftriangle"></span><a href="../../../../Raspberry-Pi/C++-Development/Cpp-Program.html">Cross-Compiling the C++ Example Project</a></li>
            <li><span class="ftriangle"></span><a href="../../../../Raspberry-Pi/C++-Development/Speedrun.html">Speedrun</a></li>
        </ul>
        </li>
    </ul>
    </li>
    <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../../Arduino/index.html">Arduino</a>
    <ul>
        <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../../Arduino/Audio-and-Signal-Processing/index.html">Audio and Signal Processing</a>
        <ul>
            <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../../Arduino/Audio-and-Signal-Processing/VU-Meters/index.html">VU Meters</a>
            <ul>
            </ul>
            </li>
        </ul>
        </li>
        <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../../Arduino/Control-Surface/index.html">Control Surface</a>
        <ul>
            <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../../Arduino/Control-Surface/Developers/index.html">Developers</a>
            <ul>
                <li><span class="ftriangle"></span><a href="../../../../Arduino/Control-Surface/Developers/Installation.html">Installation</a></li>
                <li><span class="ftriangle"></span><a href="../../../../Arduino/Control-Surface/Developers/Style.html">Style</a></li>
                <li><span class="ftriangle"></span><a href="../../../../Arduino/Control-Surface/Developers/Tests.html">Tests</a></li>
                <li><span class="ftriangle"></span><a href="../../../../Arduino/Control-Surface/Developers/Generating-Documentation.html">Generating Documentation</a></li>
            </ul>
            </li>
        </ul>
        </li>
        <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../../Arduino/Bootloaders/index.html">Bootloaders</a>
        <ul>
            <li><span class="ftriangle"></span><a href="../../../../Arduino/Bootloaders/ATmega328P-custom-frequency.html">Compiling Optiboot - ATmega328P at custom frequency</a></li>
        </ul>
        </li>
        <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../../Arduino/ESP8266/index.html">ESP8266</a>
        <ul>
            <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../../Arduino/ESP8266/Flashing/index.html">Flashing</a>
            <ul>
                <li><span class="ftriangle"></span><a href="../../../../Arduino/ESP8266/Flashing/Flashing-With-an-Arduino.html">Flashing the ESP8266 with an Arduino UNO</a></li>
            </ul>
            </li>
        </ul>
        </li>
    </ul>
    </li>
    <li class="expanded"><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../index.html">Mathematics</a>
    <ul>
        <li class="expanded"><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../index.html">Systems and Control Theory</a>
        <ul>
            <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../Analog-Filters/index.html">Analog Filters &amp; Systems</a>
            <ul>
                <li><span class="ftriangle"></span><a href="../../Analog-Filters/Butterworth-Filters.html">Butterworth Filters</a></li>
            </ul>
            </li>
            <li class="expanded"><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../index.html">Digital Filters &amp; Systems</a>
            <ul>
                <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../DTLTI-Systems,-Transfer-Functions,-and-the-Z-transform/index.html">DTLTI Systems, Transfer Functions, and the Z-transform</a>
                <ul>
                    <li><span class="ftriangle"></span><a href="../DTLTI-Systems,-Transfer-Functions,-and-the-Z-transform/DTLTI-Systems.html">DTLTI Systems</a></li>
                    <li><span class="ftriangle"></span><a href="../DTLTI-Systems,-Transfer-Functions,-and-the-Z-transform/Impulse-and-Step-Response.html">Impulse and Step Response</a></li>
                    <li><span class="ftriangle"></span><a href="../DTLTI-Systems,-Transfer-Functions,-and-the-Z-transform/The-Z-transform.html">The Z-transform</a></li>
                </ul>
                </li>
                <li class="expanded"><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="index.html">Exponential Moving Average</a>
                <ul>
                    <li><span class="ftriangle"></span><a href="Exponential-Moving-Average.html">Exponential Moving Average</a></li>
                    <li><span class="ftriangle"></span><a href="Filtering-in-MATLAB.html">Filtering in MATLAB</a></li>
                    <li><span class="ftriangle"></span><a class="openEntry" href="C++Implementation.html">C++ Implementation</a></li>
                </ul>
                </li>
                <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../Simple Moving Average/index.html">Simple Moving Average</a>
                <ul>
                    <li><span class="ftriangle"></span><a href="../Simple Moving Average/Simple-Moving-Average.html">Simple Moving Average</a></li>
                    <li><span class="ftriangle"></span><a href="../Simple Moving Average/C++Implementation.html">C++ Implementation</a></li>
                </ul>
                </li>
                <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../Discretization/index.html">Discretization</a>
                <ul>
                    <li><span class="ftriangle"></span><a href="../Discretization/Bilinear-transform.html">Bilinear Transform</a></li>
                    <li><span class="ftriangle"></span><a href="../Discretization/Discretization-of-a-fourth-order-Butterworth-filter.html">Discretization of a Fourth-Order Butterworth Filter</a></li>
                </ul>
                </li>
                <li><span class="ftriangle"></span><a href="../FIR-Notch.html">Simple Finite Impulse Response Notch Filter</a></li>
            </ul>
            </li>
        </ul>
        </li>
    </ul>
    </li>
    <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../../Ubuntu/index.html">Ubuntu</a>
    <ul>
        <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../../Ubuntu/Software-Installation/index.html">Software Installation</a>
        <ul>
            <li><span class="dtriangle" onclick="this.parentElement.classList.toggle('expanded');"></span><a href="../../../../Ubuntu/Software-Installation/Arduino/index.html">Arduino</a>
            <ul>
                <li><span class="ftriangle"></span><a href="../../../../Ubuntu/Software-Installation/Arduino/Arduino-IDE.html">Arduino IDE</a></li>
                <li><span class="ftriangle"></span><a href="../../../../Ubuntu/Software-Installation/Arduino/Hairless-MIDI.html">The Hairless MIDI to Serial Bridge</a></li>
            </ul>
            </li>
            <li><span class="ftriangle"></span><a href="../../../../Ubuntu/Software-Installation/BlueZ.html">BlueZ with MIDI over BLE Support</a></li>
            <li><span class="ftriangle"></span><a href="../../../../Ubuntu/Software-Installation/Doxygen.html">Doxygen</a></li>
            <li><span class="ftriangle"></span><a href="../../../../Ubuntu/Software-Installation/Eclipse.html">Eclipse</a></li>
            <li><span class="ftriangle"></span><a href="../../../../Ubuntu/Software-Installation/Java.html">Java</a></li>
            <li><span class="ftriangle"></span><a href="../../../../Ubuntu/Software-Installation/Python.html">Python</a></li>
            <li><span class="ftriangle"></span><a href="../../../../Ubuntu/Software-Installation/VirtualBox.html">VirtualBox</a></li>
        </ul>
        </li>
    </ul>
    </li>
</ul>

            <i class="material-icons">
                <a href="/" title="Home">home</a>
            </i>
            <i class="material-icons">
                <a href="C++Implementation.pdf" title="Download as PDF">get_app</a>
            </i>
            <i class="material-icons">
                <a href="javascript:window.print()" title="Print this article">print</a>
            </i>
            <i class="material-icons">
                <a href="https://github.com/tttapa/tttapa.github.io/issues/new" target="_blank" title="Comment or open an issue">report</a>
            </i>
        </div>
    </nav>
    <article>
        <h1 class="title">C++ Implementation</h1>
        <i class="author">Pieter P</i>
        <div>

<h3><a name="dividing-by-powers-of-2" href="#dividing-by-powers-of-2">Dividing by Powers of 2</a></h3>
<p>
    The factor <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\alpha"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">α</span></span></span></span></span></span> in the difference equation of the Exponential Moving 
    Average filter is a number between zero and one. There are two main ways to 
    implement this multiplication by <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\alpha"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">α</span></span></span></span></span></span>: Either we use floating point 
    numbers and calculate the multiplication directly, or we use integers, and 
    express the multiplication as a division by <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="1/\alpha \gt 1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">/</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">α</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">&gt;</span></span><span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span>.<br>
    Both floating point multiplication and integer division are relatively 
    expensive operations, especially on embedded devices or microcontrollers.
</p>
<p>
    We can, however, choose the value for <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\alpha"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">α</span></span></span></span></span></span> in such a way that 
    <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="1/\alpha = 2^k, k \in \mathbb{N}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">/</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">α</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span><span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">∈</span></span><span class="mjx-texatom MJXc-space3"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.446em; padding-bottom: 0.298em;">N</span></span></span></span></span></span></span></span>.<br>
    This is useful, because a division by a power of two can be replaced by a 
    very fast right bitshift:
    <span class="mjpage mjpage__block"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span class="mjx-math" aria-label=" \alpha \cdot x = \frac{x}{2^k} = x \gg k "><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">α</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.104em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.104em; top: -1.144em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span><span class="mjx-denominator" style="width: 1.104em; bottom: -0.992em;"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 1.104em;" class="mjx-line"></span></span><span style="height: 2.135em; vertical-align: -0.992em;" class="mjx-vsize"></span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">≫</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span></span>
</p>
<p>
    We can now rewrite the difference equation of the EMA with this optimization
    in mind:
    <span class="mjpage mjpage__block"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span class="mjx-math" aria-label=" \begin{split}
       y[n] &amp;= \alpha x[n] + (1 - \alpha) y[n-1] \\
            &amp;= y[n-1] + \alpha \left(x[n] - y[n-1]\right) \\
            &amp;= y[n-1] + \frac{x[n] - y[n-1]}{2^k} \\
            &amp;= y[n-1] + \left(x[n] - y[n-1]\right) \gg k 
       \end{split} "><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mtable" style="vertical-align: -3.103em; padding: 0px 0.167em;"><span class="mjx-table"><span class="mjx-mtr" style="height: 1.225em;"><span class="mjx-mtd" style="padding: 0px 0px 0px 0px; text-align: right; width: 1.652em;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0px 0px 0px 0px; text-align: left; width: 15.11em;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">α</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">α</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-strut"></span></span></span></span><span class="mjx-mtr" style="height: 1.375em;"><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: left;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">α</span></span><span class="mjx-mrow MJXc-space1"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span><span class="mjx-strut"></span></span></span></span><span class="mjx-mtr" style="height: 2.882em;"><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: 0.59em;"><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: left;"><span class="mjx-mrow"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 6.525em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 6.525em; top: -1.59em;"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span></span><span class="mjx-denominator" style="width: 6.525em; bottom: -0.992em;"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 6.525em;" class="mjx-line"></span></span><span style="height: 2.582em; vertical-align: -0.992em;" class="mjx-vsize"></span></span><span class="mjx-strut"></span></span></span></span><span class="mjx-mtr" style="height: 1.225em;"><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: left;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mrow MJXc-space2"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">≫</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span></span></span>
</p>
<h4><a name="negative-numbers" href="#negative-numbers">Negative Numbers</a></h4>
<p>
    There's one caveat though: this doesn't work for negative numbers. 
    For example, if we try to calculate the integer division <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="-15 / 4"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">15</span></span><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">/</span></span></span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">4</span></span></span></span></span></span> using 
    this method, we get the following answer:
    <span class="mjpage mjpage__block"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span class="mjx-math" aria-label=" \begin{split}
       -15 / 4   &amp;= -15 \cdot 2^{-2} \\
       -15 \gg 2 &amp;= 0b11110001 \gg 2 \\
                 &amp;= 0b11111100 \\
                 &amp;= -4
       \end{split} "><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mtable" style="vertical-align: -2.291em; padding: 0px 0.167em;"><span class="mjx-table"><span class="mjx-mtr" style="height: 1.332em;"><span class="mjx-mtd" style="padding: 0px 0px 0px 0px; text-align: right; width: 3.834em;"><span class="mjx-mrow" style="margin-top: -0.093em;"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">15</span></span><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">/</span></span></span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">4</span></span><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0px 0px 0px 0px; text-align: left; width: 8.318em;"><span class="mjx-mrow" style="margin-top: -0.093em;"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">15</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span class="mjx-mtr" style="height: 1.3em;"><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">15</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">≫</span></span><span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: left;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">11110001</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">≫</span></span><span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span><span class="mjx-strut"></span></span></span></span><span class="mjx-mtr" style="height: 1.3em;"><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: left;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">11111100</span></span><span class="mjx-strut"></span></span></span></span><span class="mjx-mtr" style="height: 1.15em;"><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: left;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">4</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span></span></span>
    This is not what we expected! Integer division in programming languages such
    as C++ returns the quotient truncated towards zero, so we would expect a 
    value of <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="-3"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">3</span></span></span></span></span></span>. The result is close, but incorrect nonetheless.
</p>
<p>
    This means we'll have to be careful not to use this trick on any negative
    numbers. In our difference equation, both the input <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x[n]"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span></span></span></span> and the output
    <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y[n]"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span></span></span></span> will generally be positive numbers, so no problem there, but their
    difference can be negative. 
    This is a problem. We'll have to come up with a different representation of
    the difference equation that doesn't require us to divide any negative 
    numbers:
    <span class="mjpage mjpage__block"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span class="mjx-math" aria-label=" \begin{split}
       y[n] &amp;= y[n-1] + \alpha \left(x[n] - y[n-1]\right) \\
       y[n] &amp;= y[n-1] + \frac{x[n] - y[n-1]}{2^k} \\
       2^k y[n] &amp;= 2^k y[n-1] + x[n] - y[n-1] \\[8pt]
       &amp;\ z[n] \triangleq 2^k y[n] \Leftrightarrow y[n] = 2^{-k} z[n]\\[8pt]
       z[n] &amp;= z[n-1] + x[n] - 2^{-k} z[n-1]
       \end{split} "><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mtable" style="vertical-align: -4.78em; padding: 0px 0.167em;"><span class="mjx-table"><span class="mjx-mtr" style="height: 1.225em;"><span class="mjx-mtd" style="padding: 0px 0px 0px 0px; text-align: right; width: 2.556em;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0px 0px 0px 0px; text-align: left; width: 13.84em;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">α</span></span><span class="mjx-mrow MJXc-space1"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span><span class="mjx-strut"></span></span></span></span><span class="mjx-mtr" style="height: 2.882em;"><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: 0.59em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: left;"><span class="mjx-mrow"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 6.525em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 6.525em; top: -1.59em;"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span></span><span class="mjx-denominator" style="width: 6.525em; bottom: -0.992em;"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 6.525em;" class="mjx-line"></span></span><span style="height: 2.582em; vertical-align: -0.992em;" class="mjx-vsize"></span></span><span class="mjx-strut"></span></span></span></span><span class="mjx-mtr" style="height: 1.901em;"><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: -0.074em;"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: left;"><span class="mjx-mrow" style="margin-top: -0.074em;"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-strut"></span></span></span></span><span class="mjx-mtr" style="height: 2.301em;"><span class="mjx-mtd" style="padding: 0.55em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: -0.074em;"><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0.55em 0px 0px 0px; text-align: left;"><span class="mjx-mrow" style="margin-top: -0.074em;"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.291em; padding-bottom: 0.372em;">&nbsp;</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.593em; padding-bottom: 0.298em;">≜</span></span><span class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">⇔</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-strut"></span></span></span></span><span class="mjx-mtr" style="height: 1.751em;"><span class="mjx-mtd" style="padding: 0.55em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: -0.074em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0.55em 0px 0px 0px; text-align: left;"><span class="mjx-mrow" style="margin-top: -0.074em;"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span></span></span>
    We now have to prove that <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="z[n-1]"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span></span></span></span> is greater than or equal to zero. 
    We'll prove this using induction:
    </p><div style="padding-left: 2em">
        <u>Base case</u>: <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\quad n-1 = -1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mspace" style="width: 1em; height: 0px;"></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span>
        <div style="padding: 0.75em">
            The value of <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="z[-1]"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span></span></span></span> is the initial state of the system. We can 
            just choose any value, so we'll pick a value that's greater than or 
            equal to zero: <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="z[-1] \ge 0"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≥</span></span><span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span></span></span>.
        </div>
        <u>Induction step</u>: <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\quad n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mspace" style="width: 1em; height: 0px;"></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span>
        <div style="padding: 0.75em">
            Given that <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="z[n-1] \ge 0"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≥</span></span><span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span></span></span>, we can now use the difference equation 
            to prove that <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="z[n]"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span></span></span></span> is also greater than zero:<br>
            <span class="mjpage mjpage__block"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span class="mjx-math" aria-label=" z[n] = z[n-1] + x[n] - 2^{-k} z[n-1] "><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span></span></span></span>
            We know that the input <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x[n]"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span></span></span></span> is always zero or positive. <br>
            Since <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="k \gt 1 \Rightarrow 2^{-k} \lt 1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">&gt;</span></span><span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">⇒</span></span><span class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">&lt;</span></span><span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span>, and since <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="z[n-1]"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span></span></span></span> is 
            zero or positive as well, we know that <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="z[n-1] \ge 2^{-k} z[n-1] 
            \Rightarrow z[n-1] - 2^{-k} z[n-1] \ge 0"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≥</span></span><span class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">⇒</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≥</span></span><span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span></span></span>.<br>
            Therefore, the entire right-hand side is always positive or zero, 
            because it is a sum of two numbers that are themselves greater than
            or equal to zero. <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\quad\Box"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mspace" style="width: 1em; height: 0px;"></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.446em; padding-bottom: 0.298em;">□</span></span></span></span></span></span>
        </div>
    </div>
<p></p>
<h4><a name="rounding" href="#rounding">Rounding</a></h4>
<p>
    A final improvement we can make to our division algorithm is to round the
    result to the nearest integer, instead of truncating it towards zero.<br>
    Consider the rounded result of the division <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="a/b"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">/</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span></span></span></span></span>. We can then express it
    as a flooring of the result plus one half:
    <span class="mjpage mjpage__block"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span class="mjx-math" aria-label=" \begin{split} 
       \left\lfloor \frac{a}{b} \right\rceil &amp;= 
           \left\lfloor \frac{a}{b} + \frac{1}{2} \right\rfloor \\
        &amp;= \left\lfloor \frac{a + \frac{b}{2}}{b} \right\rfloor \\
       \end{split} "><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mtable" style="vertical-align: -2.883em; padding: 0px 0.167em;"><span class="mjx-table"><span class="mjx-mtr" style="height: 2.599em;"><span class="mjx-mtd" style="padding: 0px 0px 0px 0px; text-align: right; width: 2.135em;"><span class="mjx-mrow"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.256em; padding-bottom: 1.256em;">⌊</span></span><span class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.729em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.729em; top: -1.143em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span><span class="mjx-denominator" style="width: 0.729em; bottom: -0.795em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 0.729em;" class="mjx-line"></span></span><span style="height: 1.938em; vertical-align: -0.795em;" class="mjx-vsize"></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.256em; padding-bottom: 1.256em;">⌉</span></span></span><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0px 0px 0px 0px; text-align: left; width: 5.631em;"><span class="mjx-mrow"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mrow MJXc-space3"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.256em; padding-bottom: 1.256em;">⌊</span></span><span class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.729em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.729em; top: -1.143em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span><span class="mjx-denominator" style="width: 0.729em; bottom: -0.795em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 0.729em;" class="mjx-line"></span></span><span style="height: 1.938em; vertical-align: -0.795em;" class="mjx-vsize"></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.368em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.756em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 0.7em;" class="mjx-line"></span></span><span style="height: 2.124em; vertical-align: -0.756em;" class="mjx-vsize"></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.256em; padding-bottom: 1.256em;">⌋</span></span></span><span class="mjx-strut"></span></span></span></span><span class="mjx-mtr" style="height: 3.667em;"><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: 1.009em;"><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: left;"><span class="mjx-mrow"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mrow MJXc-space3"><span class="mjx-mo" style="vertical-align: -0.84em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.372em; padding-bottom: 0.298em;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.372em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.961em; padding-bottom: 0.888em;">⎣</span></span></span><span class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 2.686em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 2.686em; top: -2.009em;"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.411em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.665em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 0.495em;" class="mjx-line"></span></span><span style="height: 1.468em; vertical-align: -0.47em;" class="mjx-vsize"></span></span></span></span><span class="mjx-denominator" style="width: 2.686em; bottom: -0.795em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 2.686em;" class="mjx-line"></span></span><span style="height: 2.804em; vertical-align: -0.795em;" class="mjx-vsize"></span></span><span class="mjx-mo" style="vertical-align: -0.84em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.372em; padding-bottom: 0.298em;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.372em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.961em; padding-bottom: 0.888em;">⎦</span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span></span></span>
    When <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="b"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span></span></span></span></span> is a power of two, this is equivalent to:
    <span class="mjpage mjpage__block"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span class="mjx-math" aria-label=" \begin{split} 
    \left\lfloor \frac{a}{2^k} \right\rceil &amp;= 
        \left\lfloor \frac{a}{2^k} + \frac{1}{2} \right\rfloor \\
     &amp;= \left\lfloor \frac{a + \frac{2^k}{2}}{2^k} \right\rfloor \\
     &amp;= \left\lfloor \frac{a + 2^{k-1}}{2^k} \right\rfloor \\
     &amp;= \left(a + 1 \ll \left(k-1\right)\right) \gg k \\
    \end{split} "><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mtable" style="vertical-align: -5.423em; padding: 0px 0.167em;"><span class="mjx-table"><span class="mjx-mtr" style="height: 2.617em;"><span class="mjx-mtd" style="padding: 0px 0px 0px 0px; text-align: right; width: 2.51em;"><span class="mjx-mrow"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.256em; padding-bottom: 1.256em;">⌊</span></span><span class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.104em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.104em; top: -1.143em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span><span class="mjx-denominator" style="width: 1.104em; bottom: -0.992em;"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 1.104em;" class="mjx-line"></span></span><span style="height: 2.134em; vertical-align: -0.992em;" class="mjx-vsize"></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.256em; padding-bottom: 1.256em;">⌉</span></span></span><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0px 0px 0px 0px; text-align: left; width: 11.017em;"><span class="mjx-mrow"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mrow MJXc-space3"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.256em; padding-bottom: 1.256em;">⌊</span></span><span class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.104em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.104em; top: -1.143em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span><span class="mjx-denominator" style="width: 1.104em; bottom: -0.992em;"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 1.104em;" class="mjx-line"></span></span><span style="height: 2.134em; vertical-align: -0.992em;" class="mjx-vsize"></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.368em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.756em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 0.7em;" class="mjx-line"></span></span><span style="height: 2.124em; vertical-align: -0.756em;" class="mjx-vsize"></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.256em; padding-bottom: 1.256em;">⌋</span></span></span><span class="mjx-strut"></span></span></span></span><span class="mjx-mtr" style="height: 4.155em;"><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: 1.177em;"><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: left;"><span class="mjx-mrow"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mrow MJXc-space3"><span class="mjx-mo" style="vertical-align: -1.008em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.372em; padding-bottom: 0.298em;">⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.485em; margin-bottom: -0.101em; margin-top: 0px;">⎢
⎢
⎢</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.961em; padding-bottom: 0.888em;">⎣</span></span></span><span class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 3.023em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 3.023em; top: -2.177em;"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 0.831em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.176em; top: -1.65em;"><span class="mjx-msubsup" style=""><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 83.3%; vertical-align: 0.443em; padding-left: 0px; padding-right: 0.06em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.176em; bottom: -0.665em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 0.831em;" class="mjx-line"></span></span><span style="height: 1.637em; vertical-align: -0.47em;" class="mjx-vsize"></span></span></span></span><span class="mjx-denominator" style="width: 3.023em; bottom: -0.992em;"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 3.023em;" class="mjx-line"></span></span><span style="height: 3.169em; vertical-align: -0.992em;" class="mjx-vsize"></span></span><span class="mjx-mo" style="vertical-align: -1.008em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.372em; padding-bottom: 0.298em;">⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.485em; margin-bottom: -0.101em; margin-top: 0px;">⎥
⎥
⎥</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.961em; padding-bottom: 0.888em;">⎦</span></span></span></span><span class="mjx-strut"></span></span></span></span><span class="mjx-mtr" style="height: 3.349em;"><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: 0.775em;"><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: left;"><span class="mjx-mrow"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mrow MJXc-space3"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.551em; padding-bottom: 1.551em;">⌊</span></span><span class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 3.759em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 3.759em; top: -1.603em;"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="width: 3.759em; bottom: -0.992em;"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 3.759em;" class="mjx-line"></span></span><span style="height: 2.594em; vertical-align: -0.992em;" class="mjx-vsize"></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.551em; padding-bottom: 1.551em;">⌋</span></span></span><span class="mjx-strut"></span></span></span></span><span class="mjx-mtr" style="height: 1.225em;"><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: left;"><span class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mrow MJXc-space3"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">≪</span></span><span class="mjx-mrow MJXc-space3"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">≫</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span></span></span>
</p>
<h3><a name="implementation-in-c" href="#implementation-in-c">Implementation in C++</a></h3>
<p>
    We now have everything in place to write an implementation of the EMA in 
    C++:
</p>

<h4 class="snippet-name"><a name="ema-cpp" href="#ema-cpp">EMA.cpp</a></h4>
<div class="codesnippet"><style>.pygments118 .hll { background-color: #ffffcc }
.pygments118  { background: #f8f8f8; }
.pygments118 .c { color: #408080; font-style: italic } /* Comment */
.pygments118 .err { border: 1px solid #FF0000 } /* Error */
.pygments118 .k { color: #008000; font-weight: bold } /* Keyword */
.pygments118 .o { color: #666666 } /* Operator */
.pygments118 .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.pygments118 .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.pygments118 .cp { color: #BC7A00 } /* Comment.Preproc */
.pygments118 .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.pygments118 .c1 { color: #408080; font-style: italic } /* Comment.Single */
.pygments118 .cs { color: #408080; font-style: italic } /* Comment.Special */
.pygments118 .gd { color: #A00000 } /* Generic.Deleted */
.pygments118 .ge { font-style: italic } /* Generic.Emph */
.pygments118 .gr { color: #FF0000 } /* Generic.Error */
.pygments118 .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.pygments118 .gi { color: #00A000 } /* Generic.Inserted */
.pygments118 .go { color: #888888 } /* Generic.Output */
.pygments118 .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.pygments118 .gs { font-weight: bold } /* Generic.Strong */
.pygments118 .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.pygments118 .gt { color: #0044DD } /* Generic.Traceback */
.pygments118 .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.pygments118 .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.pygments118 .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.pygments118 .kp { color: #008000 } /* Keyword.Pseudo */
.pygments118 .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.pygments118 .kt { color: #B00040 } /* Keyword.Type */
.pygments118 .m { color: #666666 } /* Literal.Number */
.pygments118 .s { color: #BA2121 } /* Literal.String */
.pygments118 .na { color: #7D9029 } /* Name.Attribute */
.pygments118 .nb { color: #008000 } /* Name.Builtin */
.pygments118 .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.pygments118 .no { color: #880000 } /* Name.Constant */
.pygments118 .nd { color: #AA22FF } /* Name.Decorator */
.pygments118 .ni { color: #999999; font-weight: bold } /* Name.Entity */
.pygments118 .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.pygments118 .nf { color: #0000FF } /* Name.Function */
.pygments118 .nl { color: #A0A000 } /* Name.Label */
.pygments118 .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.pygments118 .nt { color: #008000; font-weight: bold } /* Name.Tag */
.pygments118 .nv { color: #19177C } /* Name.Variable */
.pygments118 .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.pygments118 .w { color: #bbbbbb } /* Text.Whitespace */
.pygments118 .mb { color: #666666 } /* Literal.Number.Bin */
.pygments118 .mf { color: #666666 } /* Literal.Number.Float */
.pygments118 .mh { color: #666666 } /* Literal.Number.Hex */
.pygments118 .mi { color: #666666 } /* Literal.Number.Integer */
.pygments118 .mo { color: #666666 } /* Literal.Number.Oct */
.pygments118 .sa { color: #BA2121 } /* Literal.String.Affix */
.pygments118 .sb { color: #BA2121 } /* Literal.String.Backtick */
.pygments118 .sc { color: #BA2121 } /* Literal.String.Char */
.pygments118 .dl { color: #BA2121 } /* Literal.String.Delimiter */
.pygments118 .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.pygments118 .s2 { color: #BA2121 } /* Literal.String.Double */
.pygments118 .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.pygments118 .sh { color: #BA2121 } /* Literal.String.Heredoc */
.pygments118 .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.pygments118 .sx { color: #008000 } /* Literal.String.Other */
.pygments118 .sr { color: #BB6688 } /* Literal.String.Regex */
.pygments118 .s1 { color: #BA2121 } /* Literal.String.Single */
.pygments118 .ss { color: #19177C } /* Literal.String.Symbol */
.pygments118 .bp { color: #008000 } /* Name.Builtin.Pseudo */
.pygments118 .fm { color: #0000FF } /* Name.Function.Magic */
.pygments118 .vc { color: #19177C } /* Name.Variable.Class */
.pygments118 .vg { color: #19177C } /* Name.Variable.Global */
.pygments118 .vi { color: #19177C } /* Name.Variable.Instance */
.pygments118 .vm { color: #19177C } /* Name.Variable.Magic */
.pygments118 .il { color: #666666 } /* Literal.Number.Integer.Long */
.pygments118 pre.snippet118 { counter-reset: line 0; }</style>
<a href="https://github.com/tttapa/tttapa.github.io/blob/e37dea01cc27e9bf8ef2ee0e0ec01bd03c7633dd/Pages-src/Raw-HTML/Mathematics/Systems-and-Control-Theory/Digital-filters/Exponential Moving Average/resources/EMA.cpp" title="Open on GitHub"><img class="github-mark" src="/Images/GitHub-Mark.svg"></a>
<div class="pygments118"><pre class="lineNumbers snippet118"><code><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp"></span></code>
<code></code>
<code><span class="k">template</span> <span class="o">&lt;</span><span class="kt">uint8_t</span> <span class="n">K</span><span class="p">,</span> <span class="k">class</span> <span class="nc">uint_t</span> <span class="o">=</span> <span class="kt">uint16_t</span><span class="o">&gt;</span></code>
<code><span class="k">class</span> <span class="nc">EMA</span> <span class="p">{</span></code>
<code>  <span class="k">public</span><span class="o">:</span></code>
<code>    <span class="n">uint_t</span> <span class="k">operator</span><span class="p">()(</span><span class="n">uint_t</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span></code>
<code>        <span class="n">z</span> <span class="o">+=</span> <span class="n">x</span><span class="p">;</span></code>
<code>        <span class="n">uint_t</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">&gt;&gt;</span> <span class="n">K</span><span class="p">;</span></code>
<code>        <span class="n">z</span> <span class="o">-=</span> <span class="n">y</span><span class="p">;</span></code>
<code>        <span class="k">return</span> <span class="n">y</span><span class="p">;</span></code>
<code>    <span class="p">}</span></code>
<code></code>
<code>    <span class="k">static_assert</span><span class="p">(</span></code>
<code>        <span class="n">uint_t</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">uint_t</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>  <span class="c1">// Check that `uint_t` is an unsigned type</span></code>
<code>        <span class="s">"Error: the uint_t type should be an unsigned integer, otherwise, "</span></code>
<code>        <span class="s">"the division using bit shifts is invalid."</span><span class="p">);</span></code>
<code></code>
<code>  <span class="k">private</span><span class="o">:</span></code>
<code>    <span class="n">uint_t</span> <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></code>
<code><span class="p">};</span></code></pre></div>
</div>

<p>
    Note how we save <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="z[n] - 2^{-k} z[n]"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span></span></span></span> instead of just <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="z[n]"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span></span></span></span>. Otherwise,
    we would have to calculate <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="2^{-k} z[n]"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span></span></span></span> twice (once to calculate 
    <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y[n]"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span></span></span></span>, and once on the next iteration to calculate <span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="2^{-k} z[n-1]"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span></span></span></span>),
    and that would be unnecessary.
</p>

<h3><a name="signed-rounding-division" href="#signed-rounding-division">Signed Rounding Division</a></h3>

<p>
    It's possible to implement a signed division using bit shifts as well. The 
    only difference is that we have to subtract 1 from the dividend if it's 
    negative.
</p>
<p>
    On ARM and x86 platforms, the performance difference between the signed and 
    unsigned version is small.<br>
    On some other architectures, like the AVR architecture used by some Arduino 
    microcontrollers, the signed version is significantly slower.
</p>
<p>
    I provided two implementations of the signed division. Notice how on x86 and
    ARM the second one is faster, while on AVR, the first one is faster.
</p>
<p>
    The code was compiled using the <code>-O2</code> optimization level.
</p>

<h4><a name="implementation-of-signed-and-unsigned-division-by-a-multiple-of-two" href="#implementation-of-signed-and-unsigned-division-by-a-multiple-of-two">Implementation of Signed and Unsigned Division by a Multiple of Two</a></h4>
<div class="codesnippet"><style>.pygments152 .hll { background-color: #ffffcc }
.pygments152  { background: #f8f8f8; }
.pygments152 .c { color: #408080; font-style: italic } /* Comment */
.pygments152 .err { border: 1px solid #FF0000 } /* Error */
.pygments152 .k { color: #008000; font-weight: bold } /* Keyword */
.pygments152 .o { color: #666666 } /* Operator */
.pygments152 .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.pygments152 .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.pygments152 .cp { color: #BC7A00 } /* Comment.Preproc */
.pygments152 .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.pygments152 .c1 { color: #408080; font-style: italic } /* Comment.Single */
.pygments152 .cs { color: #408080; font-style: italic } /* Comment.Special */
.pygments152 .gd { color: #A00000 } /* Generic.Deleted */
.pygments152 .ge { font-style: italic } /* Generic.Emph */
.pygments152 .gr { color: #FF0000 } /* Generic.Error */
.pygments152 .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.pygments152 .gi { color: #00A000 } /* Generic.Inserted */
.pygments152 .go { color: #888888 } /* Generic.Output */
.pygments152 .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.pygments152 .gs { font-weight: bold } /* Generic.Strong */
.pygments152 .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.pygments152 .gt { color: #0044DD } /* Generic.Traceback */
.pygments152 .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.pygments152 .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.pygments152 .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.pygments152 .kp { color: #008000 } /* Keyword.Pseudo */
.pygments152 .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.pygments152 .kt { color: #B00040 } /* Keyword.Type */
.pygments152 .m { color: #666666 } /* Literal.Number */
.pygments152 .s { color: #BA2121 } /* Literal.String */
.pygments152 .na { color: #7D9029 } /* Name.Attribute */
.pygments152 .nb { color: #008000 } /* Name.Builtin */
.pygments152 .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.pygments152 .no { color: #880000 } /* Name.Constant */
.pygments152 .nd { color: #AA22FF } /* Name.Decorator */
.pygments152 .ni { color: #999999; font-weight: bold } /* Name.Entity */
.pygments152 .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.pygments152 .nf { color: #0000FF } /* Name.Function */
.pygments152 .nl { color: #A0A000 } /* Name.Label */
.pygments152 .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.pygments152 .nt { color: #008000; font-weight: bold } /* Name.Tag */
.pygments152 .nv { color: #19177C } /* Name.Variable */
.pygments152 .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.pygments152 .w { color: #bbbbbb } /* Text.Whitespace */
.pygments152 .mb { color: #666666 } /* Literal.Number.Bin */
.pygments152 .mf { color: #666666 } /* Literal.Number.Float */
.pygments152 .mh { color: #666666 } /* Literal.Number.Hex */
.pygments152 .mi { color: #666666 } /* Literal.Number.Integer */
.pygments152 .mo { color: #666666 } /* Literal.Number.Oct */
.pygments152 .sa { color: #BA2121 } /* Literal.String.Affix */
.pygments152 .sb { color: #BA2121 } /* Literal.String.Backtick */
.pygments152 .sc { color: #BA2121 } /* Literal.String.Char */
.pygments152 .dl { color: #BA2121 } /* Literal.String.Delimiter */
.pygments152 .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.pygments152 .s2 { color: #BA2121 } /* Literal.String.Double */
.pygments152 .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.pygments152 .sh { color: #BA2121 } /* Literal.String.Heredoc */
.pygments152 .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.pygments152 .sx { color: #008000 } /* Literal.String.Other */
.pygments152 .sr { color: #BB6688 } /* Literal.String.Regex */
.pygments152 .s1 { color: #BA2121 } /* Literal.String.Single */
.pygments152 .ss { color: #19177C } /* Literal.String.Symbol */
.pygments152 .bp { color: #008000 } /* Name.Builtin.Pseudo */
.pygments152 .fm { color: #0000FF } /* Name.Function.Magic */
.pygments152 .vc { color: #19177C } /* Name.Variable.Class */
.pygments152 .vg { color: #19177C } /* Name.Variable.Global */
.pygments152 .vi { color: #19177C } /* Name.Variable.Instance */
.pygments152 .vm { color: #19177C } /* Name.Variable.Magic */
.pygments152 .il { color: #666666 } /* Literal.Number.Integer.Long */
.pygments152 pre.snippet152 { counter-reset: line 0; }</style>
<a href="https://github.com/tttapa/tttapa.github.io/blob/1de283b22fc2fbc40ef2668407221353ec1014e2/Pages-src/Raw-HTML/Mathematics/Systems-and-Control-Theory/Digital-filters/Exponential Moving Average/resources/Rounding-Division.cpp" title="Open on GitHub"><img class="github-mark" src="/Images/GitHub-Mark.svg"></a>
<div class="pygments152"><pre class="lineNumbers snippet152"><code><span></span><span class="k">constexpr</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">K</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span></code>
<code></code>
<code><span class="kt">signed</span> <span class="kt">int</span> <span class="nf">div_s1</span><span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span> <span class="n">val</span><span class="p">)</span> <span class="p">{</span></code>
<code>    <span class="kt">int</span> <span class="n">round</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span></code>
<code>    <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span></code>
<code>        <span class="n">round</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span></code>
<code>    <span class="k">return</span> <span class="n">round</span> <span class="o">&gt;&gt;</span> <span class="n">K</span><span class="p">;</span></code>
<code><span class="p">}</span></code>
<code></code>
<code><span class="kt">signed</span> <span class="kt">int</span> <span class="nf">div_s2</span><span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span> <span class="n">val</span><span class="p">)</span> <span class="p">{</span></code>
<code>    <span class="kt">int</span> <span class="n">neg</span> <span class="o">=</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span></code>
<code>    <span class="k">return</span> <span class="p">(</span><span class="n">val</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="n">neg</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">K</span><span class="p">;</span></code>
<code><span class="p">}</span></code>
<code></code>
<code><span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">div_u</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">val</span><span class="p">)</span> <span class="p">{</span></code>
<code>    <span class="k">return</span> <span class="p">(</span><span class="n">val</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">&gt;&gt;</span> <span class="n">K</span><span class="p">;</span></code>
<code><span class="p">}</span></code></pre></div>
</div>
<h4><a name="assembly-generated-on-x86-64-gcc-9-2" href="#assembly-generated-on-x86-64-gcc-9-2">Assembly Generated on x86_64 (GCC 9.2)</a></h4>
<div class="codesnippet"><style>.pygments156 .hll { background-color: #ffffcc }
.pygments156  { background: #f8f8f8; }
.pygments156 .c { color: #408080; font-style: italic } /* Comment */
.pygments156 .err { border: 1px solid #FF0000 } /* Error */
.pygments156 .k { color: #008000; font-weight: bold } /* Keyword */
.pygments156 .o { color: #666666 } /* Operator */
.pygments156 .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.pygments156 .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.pygments156 .cp { color: #BC7A00 } /* Comment.Preproc */
.pygments156 .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.pygments156 .c1 { color: #408080; font-style: italic } /* Comment.Single */
.pygments156 .cs { color: #408080; font-style: italic } /* Comment.Special */
.pygments156 .gd { color: #A00000 } /* Generic.Deleted */
.pygments156 .ge { font-style: italic } /* Generic.Emph */
.pygments156 .gr { color: #FF0000 } /* Generic.Error */
.pygments156 .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.pygments156 .gi { color: #00A000 } /* Generic.Inserted */
.pygments156 .go { color: #888888 } /* Generic.Output */
.pygments156 .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.pygments156 .gs { font-weight: bold } /* Generic.Strong */
.pygments156 .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.pygments156 .gt { color: #0044DD } /* Generic.Traceback */
.pygments156 .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.pygments156 .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.pygments156 .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.pygments156 .kp { color: #008000 } /* Keyword.Pseudo */
.pygments156 .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.pygments156 .kt { color: #B00040 } /* Keyword.Type */
.pygments156 .m { color: #666666 } /* Literal.Number */
.pygments156 .s { color: #BA2121 } /* Literal.String */
.pygments156 .na { color: #7D9029 } /* Name.Attribute */
.pygments156 .nb { color: #008000 } /* Name.Builtin */
.pygments156 .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.pygments156 .no { color: #880000 } /* Name.Constant */
.pygments156 .nd { color: #AA22FF } /* Name.Decorator */
.pygments156 .ni { color: #999999; font-weight: bold } /* Name.Entity */
.pygments156 .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.pygments156 .nf { color: #0000FF } /* Name.Function */
.pygments156 .nl { color: #A0A000 } /* Name.Label */
.pygments156 .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.pygments156 .nt { color: #008000; font-weight: bold } /* Name.Tag */
.pygments156 .nv { color: #19177C } /* Name.Variable */
.pygments156 .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.pygments156 .w { color: #bbbbbb } /* Text.Whitespace */
.pygments156 .mb { color: #666666 } /* Literal.Number.Bin */
.pygments156 .mf { color: #666666 } /* Literal.Number.Float */
.pygments156 .mh { color: #666666 } /* Literal.Number.Hex */
.pygments156 .mi { color: #666666 } /* Literal.Number.Integer */
.pygments156 .mo { color: #666666 } /* Literal.Number.Oct */
.pygments156 .sa { color: #BA2121 } /* Literal.String.Affix */
.pygments156 .sb { color: #BA2121 } /* Literal.String.Backtick */
.pygments156 .sc { color: #BA2121 } /* Literal.String.Char */
.pygments156 .dl { color: #BA2121 } /* Literal.String.Delimiter */
.pygments156 .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.pygments156 .s2 { color: #BA2121 } /* Literal.String.Double */
.pygments156 .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.pygments156 .sh { color: #BA2121 } /* Literal.String.Heredoc */
.pygments156 .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.pygments156 .sx { color: #008000 } /* Literal.String.Other */
.pygments156 .sr { color: #BB6688 } /* Literal.String.Regex */
.pygments156 .s1 { color: #BA2121 } /* Literal.String.Single */
.pygments156 .ss { color: #19177C } /* Literal.String.Symbol */
.pygments156 .bp { color: #008000 } /* Name.Builtin.Pseudo */
.pygments156 .fm { color: #0000FF } /* Name.Function.Magic */
.pygments156 .vc { color: #19177C } /* Name.Variable.Class */
.pygments156 .vg { color: #19177C } /* Name.Variable.Global */
.pygments156 .vi { color: #19177C } /* Name.Variable.Instance */
.pygments156 .vm { color: #19177C } /* Name.Variable.Magic */
.pygments156 .il { color: #666666 } /* Literal.Number.Integer.Long */
.pygments156 pre.snippet156 { counter-reset: line 0; }</style>
<a href="https://github.com/tttapa/tttapa.github.io/blob/1de283b22fc2fbc40ef2668407221353ec1014e2/Pages-src/Raw-HTML/Mathematics/Systems-and-Control-Theory/Digital-filters/Exponential Moving Average/resources/Rounding-Division-x86_64.S" title="Open on GitHub"><img class="github-mark" src="/Images/GitHub-Mark.svg"></a>
<div class="pygments156"><pre class="lineNumbers snippet156"><code><span></span><span class="nf">div_s1</span><span class="p">(</span><span class="n">int</span><span class="p">)</span><span class="o">:</span></code>
<code>        <span class="n">mov</span>     <span class="n">eax</span><span class="p">,</span> <span class="n">edi</span></code>
<code>        <span class="n">not</span>     <span class="n">eax</span></code>
<code>        <span class="n">shr</span>     <span class="n">eax</span><span class="p">,</span> <span class="m">31</span></code>
<code>        <span class="n">lea</span>     <span class="n">eax</span><span class="p">,</span> <span class="p">[</span><span class="n">rax</span><span class="m">+3</span><span class="o">+</span><span class="n">rdi</span><span class="p">]</span></code>
<code>        <span class="n">sar</span>     <span class="n">eax</span><span class="p">,</span> <span class="m">3</span></code>
<code>        <span class="n">ret</span></code>
<code></code>
<code><span class="nf">div_s2</span><span class="p">(</span><span class="n">int</span><span class="p">)</span><span class="o">:</span></code>
<code>        <span class="n">lea</span>     <span class="n">eax</span><span class="p">,</span> <span class="p">[</span><span class="n">rdi</span><span class="m">+4</span><span class="p">]</span></code>
<code>        <span class="n">shr</span>     <span class="n">edi</span><span class="p">,</span> <span class="m">31</span></code>
<code>        <span class="n">sub</span>     <span class="n">eax</span><span class="p">,</span> <span class="n">edi</span></code>
<code>        <span class="n">sar</span>     <span class="n">eax</span><span class="p">,</span> <span class="m">3</span></code>
<code>        <span class="n">ret</span></code>
<code></code>
<code><span class="nf">div_u</span><span class="p">(</span><span class="n">unsigned</span> <span class="n">int</span><span class="p">)</span><span class="o">:</span></code>
<code>        <span class="n">lea</span>     <span class="n">eax</span><span class="p">,</span> <span class="p">[</span><span class="n">rdi</span><span class="m">+4</span><span class="p">]</span></code>
<code>        <span class="n">shr</span>     <span class="n">eax</span><span class="p">,</span> <span class="m">3</span></code>
<code>        <span class="n">ret</span></code></pre></div>
</div>
<h4><a name="assembly-generated-on-arm-64-gcc-8-2" href="#assembly-generated-on-arm-64-gcc-8-2">Assembly Generated on ARM 64 (GCC 8.2)</a></h4>
<div class="codesnippet"><style>.pygments160 .hll { background-color: #ffffcc }
.pygments160  { background: #f8f8f8; }
.pygments160 .c { color: #408080; font-style: italic } /* Comment */
.pygments160 .err { border: 1px solid #FF0000 } /* Error */
.pygments160 .k { color: #008000; font-weight: bold } /* Keyword */
.pygments160 .o { color: #666666 } /* Operator */
.pygments160 .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.pygments160 .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.pygments160 .cp { color: #BC7A00 } /* Comment.Preproc */
.pygments160 .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.pygments160 .c1 { color: #408080; font-style: italic } /* Comment.Single */
.pygments160 .cs { color: #408080; font-style: italic } /* Comment.Special */
.pygments160 .gd { color: #A00000 } /* Generic.Deleted */
.pygments160 .ge { font-style: italic } /* Generic.Emph */
.pygments160 .gr { color: #FF0000 } /* Generic.Error */
.pygments160 .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.pygments160 .gi { color: #00A000 } /* Generic.Inserted */
.pygments160 .go { color: #888888 } /* Generic.Output */
.pygments160 .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.pygments160 .gs { font-weight: bold } /* Generic.Strong */
.pygments160 .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.pygments160 .gt { color: #0044DD } /* Generic.Traceback */
.pygments160 .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.pygments160 .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.pygments160 .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.pygments160 .kp { color: #008000 } /* Keyword.Pseudo */
.pygments160 .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.pygments160 .kt { color: #B00040 } /* Keyword.Type */
.pygments160 .m { color: #666666 } /* Literal.Number */
.pygments160 .s { color: #BA2121 } /* Literal.String */
.pygments160 .na { color: #7D9029 } /* Name.Attribute */
.pygments160 .nb { color: #008000 } /* Name.Builtin */
.pygments160 .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.pygments160 .no { color: #880000 } /* Name.Constant */
.pygments160 .nd { color: #AA22FF } /* Name.Decorator */
.pygments160 .ni { color: #999999; font-weight: bold } /* Name.Entity */
.pygments160 .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.pygments160 .nf { color: #0000FF } /* Name.Function */
.pygments160 .nl { color: #A0A000 } /* Name.Label */
.pygments160 .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.pygments160 .nt { color: #008000; font-weight: bold } /* Name.Tag */
.pygments160 .nv { color: #19177C } /* Name.Variable */
.pygments160 .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.pygments160 .w { color: #bbbbbb } /* Text.Whitespace */
.pygments160 .mb { color: #666666 } /* Literal.Number.Bin */
.pygments160 .mf { color: #666666 } /* Literal.Number.Float */
.pygments160 .mh { color: #666666 } /* Literal.Number.Hex */
.pygments160 .mi { color: #666666 } /* Literal.Number.Integer */
.pygments160 .mo { color: #666666 } /* Literal.Number.Oct */
.pygments160 .sa { color: #BA2121 } /* Literal.String.Affix */
.pygments160 .sb { color: #BA2121 } /* Literal.String.Backtick */
.pygments160 .sc { color: #BA2121 } /* Literal.String.Char */
.pygments160 .dl { color: #BA2121 } /* Literal.String.Delimiter */
.pygments160 .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.pygments160 .s2 { color: #BA2121 } /* Literal.String.Double */
.pygments160 .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.pygments160 .sh { color: #BA2121 } /* Literal.String.Heredoc */
.pygments160 .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.pygments160 .sx { color: #008000 } /* Literal.String.Other */
.pygments160 .sr { color: #BB6688 } /* Literal.String.Regex */
.pygments160 .s1 { color: #BA2121 } /* Literal.String.Single */
.pygments160 .ss { color: #19177C } /* Literal.String.Symbol */
.pygments160 .bp { color: #008000 } /* Name.Builtin.Pseudo */
.pygments160 .fm { color: #0000FF } /* Name.Function.Magic */
.pygments160 .vc { color: #19177C } /* Name.Variable.Class */
.pygments160 .vg { color: #19177C } /* Name.Variable.Global */
.pygments160 .vi { color: #19177C } /* Name.Variable.Instance */
.pygments160 .vm { color: #19177C } /* Name.Variable.Magic */
.pygments160 .il { color: #666666 } /* Literal.Number.Integer.Long */
.pygments160 pre.snippet160 { counter-reset: line 0; }</style>
<a href="https://github.com/tttapa/tttapa.github.io/blob/1de283b22fc2fbc40ef2668407221353ec1014e2/Pages-src/Raw-HTML/Mathematics/Systems-and-Control-Theory/Digital-filters/Exponential Moving Average/resources/Rounding-Division-ARM.S" title="Open on GitHub"><img class="github-mark" src="/Images/GitHub-Mark.svg"></a>
<div class="pygments160"><pre class="lineNumbers snippet160"><code><span></span><span class="nf">div_s1</span><span class="p">(</span><span class="n">int</span><span class="p">)</span><span class="o">:</span></code>
<code>        <span class="n">mvn</span>     <span class="n">w1</span><span class="p">,</span> <span class="n">w0</span></code>
<code>        <span class="n">add</span>     <span class="n">w0</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">lsr</span> <span class="m">31</span></code>
<code>        <span class="n">add</span>     <span class="n">w0</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="m">3</span></code>
<code>        <span class="n">asr</span>     <span class="n">w0</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="m">3</span></code>
<code>        <span class="n">ret</span></code>
<code></code>
<code><span class="nf">div_s2</span><span class="p">(</span><span class="n">int</span><span class="p">)</span><span class="o">:</span></code>
<code>        <span class="n">add</span>     <span class="n">w1</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="m">4</span></code>
<code>        <span class="n">sub</span>     <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">lsr</span> <span class="m">31</span></code>
<code>        <span class="n">asr</span>     <span class="n">w0</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="m">3</span></code>
<code>        <span class="n">ret</span></code>
<code></code>
<code><span class="nf">div_u</span><span class="p">(</span><span class="n">unsigned</span> <span class="n">int</span><span class="p">)</span><span class="o">:</span></code>
<code>        <span class="n">add</span>     <span class="n">w0</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="m">4</span></code>
<code>        <span class="n">lsr</span>     <span class="n">w0</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="m">3</span></code>
<code>        <span class="n">ret</span></code></pre></div>
</div>
<h4><a name="assembly-generated-on-avr-gcc-5-3" href="#assembly-generated-on-avr-gcc-5-3">Assembly Generated on AVR (GCC 5.3)</a></h4>
<div class="codesnippet"><style>.pygments164 .hll { background-color: #ffffcc }
.pygments164  { background: #f8f8f8; }
.pygments164 .c { color: #408080; font-style: italic } /* Comment */
.pygments164 .err { border: 1px solid #FF0000 } /* Error */
.pygments164 .k { color: #008000; font-weight: bold } /* Keyword */
.pygments164 .o { color: #666666 } /* Operator */
.pygments164 .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.pygments164 .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.pygments164 .cp { color: #BC7A00 } /* Comment.Preproc */
.pygments164 .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.pygments164 .c1 { color: #408080; font-style: italic } /* Comment.Single */
.pygments164 .cs { color: #408080; font-style: italic } /* Comment.Special */
.pygments164 .gd { color: #A00000 } /* Generic.Deleted */
.pygments164 .ge { font-style: italic } /* Generic.Emph */
.pygments164 .gr { color: #FF0000 } /* Generic.Error */
.pygments164 .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.pygments164 .gi { color: #00A000 } /* Generic.Inserted */
.pygments164 .go { color: #888888 } /* Generic.Output */
.pygments164 .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.pygments164 .gs { font-weight: bold } /* Generic.Strong */
.pygments164 .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.pygments164 .gt { color: #0044DD } /* Generic.Traceback */
.pygments164 .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.pygments164 .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.pygments164 .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.pygments164 .kp { color: #008000 } /* Keyword.Pseudo */
.pygments164 .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.pygments164 .kt { color: #B00040 } /* Keyword.Type */
.pygments164 .m { color: #666666 } /* Literal.Number */
.pygments164 .s { color: #BA2121 } /* Literal.String */
.pygments164 .na { color: #7D9029 } /* Name.Attribute */
.pygments164 .nb { color: #008000 } /* Name.Builtin */
.pygments164 .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.pygments164 .no { color: #880000 } /* Name.Constant */
.pygments164 .nd { color: #AA22FF } /* Name.Decorator */
.pygments164 .ni { color: #999999; font-weight: bold } /* Name.Entity */
.pygments164 .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.pygments164 .nf { color: #0000FF } /* Name.Function */
.pygments164 .nl { color: #A0A000 } /* Name.Label */
.pygments164 .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.pygments164 .nt { color: #008000; font-weight: bold } /* Name.Tag */
.pygments164 .nv { color: #19177C } /* Name.Variable */
.pygments164 .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.pygments164 .w { color: #bbbbbb } /* Text.Whitespace */
.pygments164 .mb { color: #666666 } /* Literal.Number.Bin */
.pygments164 .mf { color: #666666 } /* Literal.Number.Float */
.pygments164 .mh { color: #666666 } /* Literal.Number.Hex */
.pygments164 .mi { color: #666666 } /* Literal.Number.Integer */
.pygments164 .mo { color: #666666 } /* Literal.Number.Oct */
.pygments164 .sa { color: #BA2121 } /* Literal.String.Affix */
.pygments164 .sb { color: #BA2121 } /* Literal.String.Backtick */
.pygments164 .sc { color: #BA2121 } /* Literal.String.Char */
.pygments164 .dl { color: #BA2121 } /* Literal.String.Delimiter */
.pygments164 .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.pygments164 .s2 { color: #BA2121 } /* Literal.String.Double */
.pygments164 .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.pygments164 .sh { color: #BA2121 } /* Literal.String.Heredoc */
.pygments164 .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.pygments164 .sx { color: #008000 } /* Literal.String.Other */
.pygments164 .sr { color: #BB6688 } /* Literal.String.Regex */
.pygments164 .s1 { color: #BA2121 } /* Literal.String.Single */
.pygments164 .ss { color: #19177C } /* Literal.String.Symbol */
.pygments164 .bp { color: #008000 } /* Name.Builtin.Pseudo */
.pygments164 .fm { color: #0000FF } /* Name.Function.Magic */
.pygments164 .vc { color: #19177C } /* Name.Variable.Class */
.pygments164 .vg { color: #19177C } /* Name.Variable.Global */
.pygments164 .vi { color: #19177C } /* Name.Variable.Instance */
.pygments164 .vm { color: #19177C } /* Name.Variable.Magic */
.pygments164 .il { color: #666666 } /* Literal.Number.Integer.Long */
.pygments164 pre.snippet164 { counter-reset: line 0; }</style>
<a href="https://github.com/tttapa/tttapa.github.io/blob/1de283b22fc2fbc40ef2668407221353ec1014e2/Pages-src/Raw-HTML/Mathematics/Systems-and-Control-Theory/Digital-filters/Exponential Moving Average/resources/Rounding-Division-AVR.S" title="Open on GitHub"><img class="github-mark" src="/Images/GitHub-Mark.svg"></a>
<div class="pygments164"><pre class="lineNumbers snippet164"><code><span></span><span class="nf">__zero_reg__</span> <span class="err">=</span> <span class="mi">1</span></code>
<code><span class="nf">div_s1</span><span class="p">(</span><span class="no">int</span><span class="p">):</span></code>
<code>        <span class="nf">sbrc</span> <span class="no">r25</span><span class="p">,</span><span class="mi">7</span>  <span class="c1"># Skip if Bit in Register is Cleared: val &lt; 0</span></code>
<code>        <span class="nf">rjmp</span> <span class="no">.L2</span></code>
<code>                    <span class="c1"># val &gt;= 0</span></code>
<code>        <span class="nf">adiw</span> <span class="no">r24</span><span class="p">,</span><span class="mi">4</span>  <span class="c1"># Add Immediate to Word: val + (1 &lt;&lt; (K - 1)) = val + 4</span></code>
<code>        <span class="nf">asr</span> <span class="no">r25</span>     <span class="c1"># Arithmetic Shift Right: shift high byte (preserve sign)</span></code>
<code>        <span class="nf">ror</span> <span class="no">r24</span>     <span class="c1"># Rotate Right through Carry: shift low byte</span></code>
<code>        <span class="nf">asr</span> <span class="no">r25</span>     <span class="c1"># Two more times</span></code>
<code>        <span class="nf">ror</span> <span class="no">r24</span></code>
<code>        <span class="nf">asr</span> <span class="no">r25</span></code>
<code>        <span class="nf">ror</span> <span class="no">r24</span></code>
<code>        <span class="nf">ret</span></code>
<code><span class="nl">.L2:</span>                </code>
<code>                    <span class="c1"># val &lt; 0</span></code>
<code>        <span class="nf">adiw</span> <span class="no">r24</span><span class="p">,</span><span class="mi">3</span>  <span class="c1"># Add Immediate to Word: val + (1 &lt;&lt; (K - 1)) - 1 = val + 3</span></code>
<code>        <span class="nf">asr</span> <span class="no">r25</span>     <span class="c1"># Arithmetic Shift Right: shift high byte (preserve sign)</span></code>
<code>        <span class="nf">ror</span> <span class="no">r24</span>     <span class="c1"># Rotate Right through Carry: shift low byte</span></code>
<code>        <span class="nf">asr</span> <span class="no">r25</span>     <span class="c1"># Two more times</span></code>
<code>        <span class="nf">ror</span> <span class="no">r24</span></code>
<code>        <span class="nf">asr</span> <span class="no">r25</span></code>
<code>        <span class="nf">ror</span> <span class="no">r24</span></code>
<code>        <span class="nf">ret</span></code>
<code></code>
<code><span class="nf">div_s2</span><span class="p">(</span><span class="no">int</span><span class="p">):</span></code>
<code>        <span class="nf">movw</span> <span class="no">r18</span><span class="p">,</span><span class="no">r24</span></code>
<code>        <span class="nf">subi</span> <span class="no">r18</span><span class="p">,-</span><span class="mi">4</span>   <span class="c1"># Subtract immediate: val + (1 &lt;&lt; (K - 1)) = val + 4</span></code>
<code>        <span class="nf">sbci</span> <span class="no">r19</span><span class="p">,-</span><span class="mi">1</span>   <span class="c1"># Subtract Immediate with Carry: (low byte)</span></code>
<code>        <span class="nf">mov</span> <span class="no">r24</span><span class="p">,</span><span class="no">r25</span></code>
<code>        <span class="nf">rol</span> <span class="no">r24</span>       <span class="c1"># Rotate Left through Carry: C flag is now sign bit</span></code>
<code>        <span class="nf">clr</span> <span class="no">r24</span>       <span class="c1"># Clear Register: set 24 to 0</span></code>
<code>        <span class="nf">rol</span> <span class="no">r24</span>       <span class="c1"># Rotate Left through Carry: lsb is now sign bit</span></code>
<code>        <span class="nf">movw</span> <span class="no">r20</span><span class="p">,</span><span class="no">r18</span></code>
<code>        <span class="nf">sub</span> <span class="no">r20</span><span class="p">,</span><span class="no">r24</span>   <span class="c1"># Subtract without Carry: val + 4 - neg</span></code>
<code>        <span class="nf">sbc</span> <span class="no">r21</span><span class="p">,</span><span class="no">__zero_reg__</span>  <span class="c1"># Subtract with Carry: (low byte)</span></code>
<code>        <span class="nf">movw</span> <span class="no">r24</span><span class="p">,</span><span class="no">r20</span></code>
<code>        <span class="nf">asr</span> <span class="no">r25</span>       <span class="c1"># Arithmetic Shift Right: shift high byte (preserve sign)</span></code>
<code>        <span class="nf">ror</span> <span class="no">r24</span>       <span class="c1"># Rotate Right through Carry: shift low byte</span></code>
<code>        <span class="nf">asr</span> <span class="no">r25</span>       <span class="c1"># Two more times</span></code>
<code>        <span class="nf">ror</span> <span class="no">r24</span></code>
<code>        <span class="nf">asr</span> <span class="no">r25</span></code>
<code>        <span class="nf">ror</span> <span class="no">r24</span></code>
<code>        <span class="nf">ret</span></code>
<code></code>
<code><span class="nf">div_u</span><span class="p">(</span><span class="no">unsigned</span> <span class="no">int</span><span class="p">):</span></code>
<code>        <span class="nf">adiw</span> <span class="no">r24</span><span class="p">,</span><span class="mi">4</span>  <span class="c1"># Add Immediate to Word: val + (1 &lt;&lt; (K - 1)) = val + 4</span></code>
<code>        <span class="nf">lsr</span> <span class="no">r25</span>     <span class="c1"># Logical Shift Right: shift high byte (no sign extension)</span></code>
<code>        <span class="nf">ror</span> <span class="no">r24</span>     <span class="c1"># Rotate Right through Carry: shift low byte</span></code>
<code>        <span class="nf">lsr</span> <span class="no">r25</span>     <span class="c1"># Two more times</span></code>
<code>        <span class="nf">ror</span> <span class="no">r24</span></code>
<code>        <span class="nf">lsr</span> <span class="no">r25</span></code>
<code>        <span class="nf">ror</span> <span class="no">r24</span></code>
<code>        <span class="nf">ret</span></code></pre></div>
</div>
<p>
    Keep in mind that an <code>int</code> on AVR is only 16 bits wide, whereas an <code>int</code> on ARM or x86 is
    32 bits wide.<br>
    If you use 32-bit integers on AVR, the result is even more atrocious.
</p>
<p>
    You can try it for yourself on the <a href="https://godbolt.org/z/cmQJ7W">Compiler Explorer</a>.
</p>

<h3><a name="arduino-example" href="#arduino-example">Arduino Example</a></h3>

<div class="codesnippet"><style>.pygments178 .hll { background-color: #ffffcc }
.pygments178  { background: #ffffff; }
.pygments178 .c { color: #95a5a6 } /* Comment */
.pygments178 .err { color: #a61717 } /* Error */
.pygments178 .k { color: #728E00 } /* Keyword */
.pygments178 .n { color: #434f54 } /* Name */
.pygments178 .o { color: #728E00 } /* Operator */
.pygments178 .ch { color: #95a5a6 } /* Comment.Hashbang */
.pygments178 .cm { color: #95a5a6 } /* Comment.Multiline */
.pygments178 .cp { color: #728E00 } /* Comment.Preproc */
.pygments178 .cpf { color: #95a5a6 } /* Comment.PreprocFile */
.pygments178 .c1 { color: #95a5a6 } /* Comment.Single */
.pygments178 .cs { color: #95a5a6 } /* Comment.Special */
.pygments178 .kc { color: #00979D } /* Keyword.Constant */
.pygments178 .kd { color: #728E00 } /* Keyword.Declaration */
.pygments178 .kn { color: #728E00 } /* Keyword.Namespace */
.pygments178 .kp { color: #00979D } /* Keyword.Pseudo */
.pygments178 .kr { color: #00979D } /* Keyword.Reserved */
.pygments178 .kt { color: #00979D } /* Keyword.Type */
.pygments178 .m { color: #8A7B52 } /* Literal.Number */
.pygments178 .s { color: #7F8C8D } /* Literal.String */
.pygments178 .na { color: #434f54 } /* Name.Attribute */
.pygments178 .nb { color: #728E00 } /* Name.Builtin */
.pygments178 .nc { color: #434f54 } /* Name.Class */
.pygments178 .no { color: #434f54 } /* Name.Constant */
.pygments178 .nd { color: #434f54 } /* Name.Decorator */
.pygments178 .ni { color: #434f54 } /* Name.Entity */
.pygments178 .ne { color: #434f54 } /* Name.Exception */
.pygments178 .nf { color: #D35400 } /* Name.Function */
.pygments178 .nl { color: #434f54 } /* Name.Label */
.pygments178 .nn { color: #434f54 } /* Name.Namespace */
.pygments178 .nx { color: #728E00 } /* Name.Other */
.pygments178 .py { color: #434f54 } /* Name.Property */
.pygments178 .nt { color: #434f54 } /* Name.Tag */
.pygments178 .nv { color: #434f54 } /* Name.Variable */
.pygments178 .ow { color: #728E00 } /* Operator.Word */
.pygments178 .mb { color: #8A7B52 } /* Literal.Number.Bin */
.pygments178 .mf { color: #8A7B52 } /* Literal.Number.Float */
.pygments178 .mh { color: #8A7B52 } /* Literal.Number.Hex */
.pygments178 .mi { color: #8A7B52 } /* Literal.Number.Integer */
.pygments178 .mo { color: #8A7B52 } /* Literal.Number.Oct */
.pygments178 .sa { color: #7F8C8D } /* Literal.String.Affix */
.pygments178 .sb { color: #7F8C8D } /* Literal.String.Backtick */
.pygments178 .sc { color: #7F8C8D } /* Literal.String.Char */
.pygments178 .dl { color: #7F8C8D } /* Literal.String.Delimiter */
.pygments178 .sd { color: #7F8C8D } /* Literal.String.Doc */
.pygments178 .s2 { color: #7F8C8D } /* Literal.String.Double */
.pygments178 .se { color: #7F8C8D } /* Literal.String.Escape */
.pygments178 .sh { color: #7F8C8D } /* Literal.String.Heredoc */
.pygments178 .si { color: #7F8C8D } /* Literal.String.Interpol */
.pygments178 .sx { color: #7F8C8D } /* Literal.String.Other */
.pygments178 .sr { color: #7F8C8D } /* Literal.String.Regex */
.pygments178 .s1 { color: #7F8C8D } /* Literal.String.Single */
.pygments178 .ss { color: #7F8C8D } /* Literal.String.Symbol */
.pygments178 .bp { color: #728E00 } /* Name.Builtin.Pseudo */
.pygments178 .fm { color: #D35400 } /* Name.Function.Magic */
.pygments178 .vc { color: #434f54 } /* Name.Variable.Class */
.pygments178 .vg { color: #434f54 } /* Name.Variable.Global */
.pygments178 .vi { color: #434f54 } /* Name.Variable.Instance */
.pygments178 .vm { color: #434f54 } /* Name.Variable.Magic */
.pygments178 .il { color: #8A7B52 } /* Literal.Number.Integer.Long */
.pygments178 pre.snippet178 { counter-reset: line 0; }</style>
<a href="https://github.com/tttapa/tttapa.github.io/blob/e37dea01cc27e9bf8ef2ee0e0ec01bd03c7633dd/Pages-src/Raw-HTML/Mathematics/Systems-and-Control-Theory/Digital-filters/Exponential Moving Average/resources/EMA-Arduino.ino" title="Open on GitHub"><img class="github-mark" src="/Images/GitHub-Mark.svg"></a>
<div class="pygments178"><pre class="lineNumbers snippet178"><code><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kr">uint8_t</span> <span class="n">K</span><span class="p">,</span> <span class="kr">class</span> <span class="nc">uint_t</span> <span class="o">=</span> <span class="kr">uint16_t</span><span class="o">&gt;</span></code>
<code><span class="kr">class</span> <span class="nc">EMA</span> <span class="p">{</span></code>
<code>  <span class="kr">public</span><span class="o">:</span></code>
<code>    <span class="n">uint_t</span> <span class="kr">operator</span><span class="p">()(</span><span class="n">uint_t</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span></code>
<code>        <span class="n">z</span> <span class="o">+=</span> <span class="n">x</span><span class="p">;</span></code>
<code>        <span class="n">uint_t</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">&gt;&gt;</span> <span class="n">K</span><span class="p">;</span></code>
<code>        <span class="n">z</span> <span class="o">-=</span> <span class="n">y</span><span class="p">;</span></code>
<code>        <span class="k">return</span> <span class="n">y</span><span class="p">;</span></code>
<code>    <span class="p">}</span></code>
<code></code>
<code>    <span class="n">static_assert</span><span class="p">(</span></code>
<code>        <span class="n">uint_t</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">uint_t</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>  <span class="c1">// Check that `uint_t` is an unsigned type</span></code>
<code>        <span class="s">"Error: the uint_t type should be an unsigned integer, otherwise, "</span></code>
<code>        <span class="s">"the division using bit shifts is invalid."</span><span class="p">);</span></code>
<code></code>
<code>  <span class="kr">private</span><span class="o">:</span></code>
<code>    <span class="n">uint_t</span> <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></code>
<code><span class="p">};</span></code>
<code></code>
<code><span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span></code>
<code>  <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span></code>
<code>  <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="nf">Serial</span><span class="p">);</span></code>
<code><span class="p">}</span></code>
<code></code>
<code><span class="kr">const</span> <span class="kr">unsigned</span> <span class="kr">long</span> <span class="n">interval</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">;</span> <span class="c1">// 100 Hz</span></code>
<code></code>
<code><span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span></code>
<code>  <span class="kr">static</span> <span class="n">EMA</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span> <span class="n">filter</span><span class="p">;</span></code>
<code>  <span class="kr">static</span> <span class="kr">unsigned</span> <span class="kr">long</span> <span class="n">prevMicros</span> <span class="o">=</span> <span class="nf">micros</span><span class="p">();</span></code>
<code>  <span class="k">if</span> <span class="p">(</span><span class="nf">micros</span><span class="p">()</span> <span class="o">-</span> <span class="n">prevMicros</span> <span class="o">&gt;=</span> <span class="n">interval</span><span class="p">)</span> <span class="p">{</span></code>
<code>    <span class="kr">int</span> <span class="n">rawValue</span> <span class="o">=</span> <span class="nf">analogRead</span><span class="p">(</span><span class="n">A0</span><span class="p">);</span></code>
<code>    <span class="kr">int</span> <span class="n">filteredValue</span> <span class="o">=</span> <span class="n">filter</span><span class="p">(</span><span class="n">rawValue</span><span class="p">);</span></code>
<code>    <span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">rawValue</span><span class="p">);</span></code>
<code>    <span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="sc">'\t'</span><span class="p">);</span></code>
<code>    <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">filteredValue</span><span class="p">);</span></code>
<code>    <span class="n">prevMicros</span> <span class="o">+=</span> <span class="n">interval</span><span class="p">;</span></code>
<code>  <span class="p">}</span></code>
<code><span class="p">}</span></code></pre></div>
</div> 

</div>
        <hr id="end-of-article">
        <div class="nextupprev"></div>
    </article>
    <footer>Last edited: Friday, 18 October 2019 23:39 UTC</footer>


</body></html>